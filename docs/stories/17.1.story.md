# Story 17.1: Trading Challenges System

## Status

**Draft**

---

## Story

**As a** trader,  
**I want** to participate in trading challenges with rewards,  
**so that** I can stay motivated and improve my skills.

---

## Acceptance Criteria

1. **AC1**: Page Challenges affiche challenges disponibles.
2. **AC2**: Utilisateurs peuvent rejoindre challenges (time-limited).
3. **AC3**: Challenges trackent métriques performance (win rate, profit, etc.).
4. **AC4**: Système rewards (badges, points, leaderboard).
5. **AC5**: Leaderboard updates en real-time.

---

## Tasks / Subtasks

- [ ] **Task 1: Challenges Page** (AC: 1)
  - [ ] 1.1 Créer `src/app/(dashboard)/challenges/page.tsx`
  - [ ] 1.2 Ajouter route dans sidebar navigation
  - [ ] 1.3 Afficher challenges disponibles (actifs, à venir, passés)
  - [ ] 1.4 UI shadcn/ui Card, Badge, Button

- [ ] **Task 2: Join Challenges** (AC: 2)
  - [ ] 2.1 Bouton "Join Challenge" sur challenge card
  - [ ] 2.2 Server action `joinChallenge(userId, challengeId)`
  - [ ] 2.3 Validation time limits (start date, end date)
  - [ ] 2.4 Table `ChallengeParticipant` (userId, challengeId, joinedAt)

- [ ] **Task 3: Performance Tracking** (AC: 3)
  - [ ] 3.1 Table `Challenge` (id, title, startDate, endDate, metrics, rewards)
  - [ ] 3.2 Tracking métriques (win rate, profit, RR, etc.)
  - [ ] 3.3 Calcul performance challenge (background job BullMQ)
  - [ ] 3.4 Afficher progression utilisateur dans challenge

- [ ] **Task 4: Rewards System** (AC: 4)
  - [ ] 4.1 Tables DB : `Reward` (id, challengeId, type, badge, points), `Badge` (id, userId, badgeType, earnedAt)
  - [ ] 4.2 Calcul rewards (background job BullMQ)
  - [ ] 4.3 Afficher badges/points utilisateur
  - [ ] 4.4 UI shadcn/ui Badge, Progress

- [ ] **Task 5: Leaderboard** (AC: 5)
  - [ ] 5.1 Leaderboard par challenge (top performers)
  - [ ] 5.2 Real-time updates (Supabase Realtime ou WebSockets)
  - [ ] 5.3 Classement par métriques (profit, win rate, etc.)
  - [ ] 5.4 UI shadcn/ui Table, Badge

---

## Dev Notes

- Dépendance : Phase 3 (AI), Phase 5 (Analytics).
- Tables DB : `Challenge`, `ChallengeParticipant`, `Reward`, `Badge`.
- Background jobs (BullMQ) pour calcul performance et rewards.
- Real-time leaderboard nécessite Supabase Realtime ou WebSockets.
- Référencer `docs/roadmap-trading-path-journal.md` Phase 12 (Gamification & Challenges).
