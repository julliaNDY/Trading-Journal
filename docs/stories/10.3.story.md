# Story 10.3: Admin Votes Management - CRUD

## Status

**Draft**

---

## Story

**As an** admin,  
**I want** to manage voting options (CRUD) and view results,  
**so that** I can control what users vote on and track feedback.

---

## Acceptance Criteria

1. **AC1**: Nouvel onglet "Votes" dans Admin Dashboard.
2. **AC2**: Admin peut créer nouvelles options de vote (title, description, status).
3. **AC3**: Admin peut éditer options existantes.
4. **AC4**: Admin peut supprimer options (avec confirmation).
5. **AC5**: Admin peut toggle statut option (Active/Inactive).
6. **AC6**: Admin peut voir résultats votes (compteurs, pourcentages, liste utilisateurs).

---

## Tasks / Subtasks

- [ ] **Task 1: Admin Votes Tab** (AC: 1)
  - [ ] 1.1 Étendre `src/app/(dashboard)/admin/admin-content.tsx` avec onglet "Votes"
  - [ ] 1.2 Composant `VotesManagement` dans `src/components/admin/votes-management.tsx` (existe déjà)
  - [ ] 1.3 UI shadcn/ui Tabs

- [ ] **Task 2: Create Voting Option** (AC: 2)
  - [ ] 2.1 Dialog création option (title, description, status)
  - [ ] 2.2 Server action `createVotingOption(title, description, status)`
  - [ ] 2.3 Validation (title requis, description optionnelle)
  - [ ] 2.4 UI shadcn/ui Dialog, Input, Textarea, Button

- [ ] **Task 3: Edit Voting Option** (AC: 3)
  - [ ] 3.1 Dialog édition option (pré-rempli)
  - [ ] 3.2 Server action `updateVotingOption(optionId, title, description, status)`
  - [ ] 3.3 Validation données modifiées
  - [ ] 3.4 UI shadcn/ui Dialog, Input, Textarea, Select

- [ ] **Task 4: Delete Voting Option** (AC: 4)
  - [ ] 4.1 AlertDialog confirmation avant suppression
  - [ ] 4.2 Server action `deleteVotingOption(optionId)`
  - [ ] 4.3 Supprimer votes associés (cascade ou soft delete)
  - [ ] 4.4 UI shadcn/ui AlertDialog

- [ ] **Task 5: Toggle Status** (AC: 5)
  - [ ] 5.1 Toggle bouton Active/Inactive
  - [ ] 5.2 Server action `toggleVotingOptionStatus(optionId)`
  - [ ] 5.3 Mise à jour immédiate UI
  - [ ] 5.4 UI shadcn/ui Toggle ou Switch

- [ ] **Task 6: View Vote Results** (AC: 6)
  - [ ] 6.1 Afficher compteurs votes par option
  - [ ] 6.2 Calculer pourcentages (votes / total votes)
  - [ ] 6.3 Liste utilisateurs ayant voté (email, date)
  - [ ] 6.4 UI shadcn/ui Table, Badge, Progress

---

## Dev Notes

- Dépendance : Phase 1 (Foundation), Admin Dashboard existant.
- Composant existe déjà (`src/components/admin/votes-management.tsx`).
- DB tables : `VotingOption` (id, title, description, status, createdAt, updatedAt), `Vote` (id, userId, optionId, createdAt).
- Référencer `docs/roadmap-trading-path-journal.md` Phase 10 (Admin Votes Management).
