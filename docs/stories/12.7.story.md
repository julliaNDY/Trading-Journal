# Story 12.7: 6-Step Analysis Engine - Synthesis & Final Bias

## Status

**Draft**

---

## Story

**As a** trader,  
**I want** a synthesis of all 6 steps with Final Bias and Opening Confirmation,  
**so that** I have a clear trading bias recommendation.

---

## Acceptance Criteria

1. **AC1**: Step 6 "Synthesis" combine les 5 analyses précédentes.
2. **AC2**: AI génère Final Bias : Bullish, Bearish, ou Neutral.
3. **AC3**: AI génère Opening Confirmation (niveaux/conditions clés à surveiller).
4. **AC4**: Rapport structuré avec les 6 steps + Final Bias + Opening Confirmation.
5. **AC5**: Rapport affiché dans UI avec formatage clair.

---

## Tasks / Subtasks

- [ ] **Task 1: Synthesis Engine** (AC: 1, 2, 3)
  - [ ] 1.1 Google Gemini API avec prompt synthesis (préféré à OpenAI GPT-4o)
  - [ ] 1.2 Prompt synthesise les 6 steps précédents
  - [ ] 1.3 Générer Final Bias : enum (BULLISH, BEARISH, NEUTRAL)
  - [ ] 1.4 Générer Opening Confirmation : text field

- [ ] **Task 2: Report Generation** (AC: 4)
  - [ ] 2.1 Stocker rapport complet dans `DailyBiasAnalysis` table
  - [ ] 2.2 Structure : 6 steps + Final Bias + Opening Confirmation
  - [ ] 2.3 JSON structuré pour toutes les analyses

- [ ] **Task 3: Report Display** (AC: 5)
  - [ ] 3.1 Composant `BiasReport` dans `src/components/daily-bias/bias-report.tsx`
  - [ ] 3.2 Afficher rapport avec formatage clair
  - [ ] 3.3 Sections pour chaque step + Final Bias + Opening Confirmation
  - [ ] 3.4 UI shadcn/ui Card, Badge, Separator

---

## Dev Notes

- Dépendance : Phase 3 (AI - Google Gemini API préféré), Phase 2 (Data Collection), Stories 12.2-12.6 (6-step analyses).
- ⚠️ **NOTIFICATION PM** : Google Gemini API requise (préféré à OpenAI GPT-4o, ou OpenAI en fallback).
- Synthesis nécessite toutes les analyses précédentes (steps 1-5).
- Stocker toutes les analyses en JSON (Prisma JSON field).
- Référencer `docs/roadmap-trading-path-journal.md` Phase 11 (6-Step Analysis Engine - Step 6 Synthesis & Final Bias).
