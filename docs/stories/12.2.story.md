# Story 12.2: 6-Step Analysis Engine - Security Analysis

## Status

**Draft**

---

## Story

**As a** trader,  
**I want** Security analysis as part of the 6-step process,  
**so that** I understand market security context.

---

## Acceptance Criteria

1. **AC1**: Step 1 "Security" analyse indicateurs sécurité marché.
2. **AC2**: Prompt AI inclut checklist sécurité (volatility, risk factors, etc.).
3. **AC3**: Analyse retourne évaluation sécurité structurée.
4. **AC4**: Résultats stockés dans `DailyBiasAnalysis.securityAnalysis` (JSON field).

---

## Tasks / Subtasks

- [ ] **Task 1: Security Analysis Service** (AC: 1, 2)
  - [ ] 1.1 Service `src/services/ai/daily-bias-service.ts`
  - [ ] 1.2 Google Gemini API avec prompt structuré (préféré à OpenAI GPT-4o)
  - [ ] 1.3 Prompt template inclut checklist sécurité
  - [ ] 1.4 Stocker résultats comme JSON dans Prisma (JSON field)

- [ ] **Task 2: Security Checklist** (AC: 2)
  - [ ] 2.1 Checklist sécurité : volatility, risk factors, market conditions
  - [ ] 2.2 Prompt structuré avec checklist
  - [ ] 2.3 Extraction réponse JSON structurée

- [ ] **Task 3: Data Storage** (AC: 4)
  - [ ] 3.1 Table `DailyBiasAnalysis.securityAnalysis` (JSON field Prisma)
  - [ ] 3.2 Stocker résultats analyse sécurité
  - [ ] 3.3 Validation format JSON

---

## Dev Notes

- Dépendance : Phase 3 (AI - Google Gemini API préféré), Phase 2 (Data Collection).
- ⚠️ **NOTIFICATION PM** : Google Gemini API requise (préféré à OpenAI GPT-4o, ou OpenAI en fallback).
- Stocker toutes les analyses en JSON (Prisma JSON field).
- Référencer `docs/roadmap-trading-path-journal.md` Phase 11 (6-Step Analysis Engine - Step 1 Security).
