# Story 6.3: TradingView Visualizations - Entry/Exit Overlays

## Status

**Draft**

---

## Story

**As a** trader,  
**I want** to see my trade entries and exits overlaid on TradingView charts,  
**so that** I can visualize execution points on market data.

---

## Acceptance Criteria

1. **AC1**: TradingView Lightweight Charts intégré (composant réutilisable).
2. **AC2**: Overlay entrées/sorties sur chart (entry price, exit price, stop loss).
3. **AC3**: Markers visuels (entry marker, exit marker, stop loss marker).
4. **AC4**: Tooltips avec détails (price, timestamp, PnL).
5. **AC5**: Synchronisation symbole/timeframe avec trade sélectionné.
6. **AC6**: Performance : UI Charts responsive (< 2s load).

---

## Tasks / Subtasks

- [ ] **Task 1: TradingView Integration** (AC: 1)
  - [ ] 1.1 Vérifier TradingView Lightweight Charts intégré (composant existant)
  - [ ] 1.2 Composant réutilisable `src/components/charts/tradingview-chart.tsx`
  - [ ] 1.3 Props : symbol, timeframe, trades (array)
  - [ ] 1.4 Configuration chart (colors, layout)

- [ ] **Task 2: Entry/Exit Overlay** (AC: 2)
  - [ ] 2.1 Overlay entrées/sorties sur chart (entry price, exit price, stop loss)
  - [ ] 2.2 Markers TradingView (entry marker, exit marker, stop loss marker)
  - [ ] 2.3 Couleurs : entry (vert), exit (rouge/vert selon PnL), stop loss (orange)
  - [ ] 2.4 Lignes horizontales (entry line, exit line, stop loss line)

- [ ] **Task 3: Visual Markers** (AC: 3)
  - [ ] 3.1 Entry marker (icône flèche haut, vert)
  - [ ] 3.2 Exit marker (icône flèche bas, rouge/vert selon PnL)
  - [ ] 3.3 Stop loss marker (icône X, orange)
  - [ ] 3.4 Position markers (timestamp trade)

- [ ] **Task 4: Tooltips** (AC: 4)
  - [ ] 4.1 Tooltips avec détails (price, timestamp, PnL)
  - [ ] 4.2 Hover sur markers affiche tooltip
  - [ ] 4.3 Format tooltip : "Entry: $100.50 at 10:30 AM" + PnL
  - [ ] 4.4 UI shadcn/ui (Tooltip component)

- [ ] **Task 5: Symbol/Timeframe Sync** (AC: 5)
  - [ ] 5.1 Synchronisation symbole/timeframe avec trade sélectionné
  - [ ] 5.2 Chart affiche symbole du trade (Trade.symbol)
  - [ ] 5.3 Timeframe adapté (1m, 5m, 15m selon durée trade)
  - [ ] 5.4 Auto-zoom sur période trade (openedAt → closedAt)

- [ ] **Task 6: Performance Optimization** (AC: 6)
  - [ ] 6.1 Optimiser loading chart (< 2s)
  - [ ] 6.2 Lazy loading données (load on scroll)
  - [ ] 6.3 Benchmark performance (Lighthouse)
  - [ ] 6.4 Web Workers si nécessaire (rendering asynchrone)

---

## Dev Notes

- Dépendance : Epic 2 (Market Replay Infrastructure).
- TradingView Lightweight Charts : vérifier composant existant (code existant).
- Performance critique : < 2s load (roadmap).
- Référencer `docs/roadmap-trading-path-journal.md` Phase 6 (Visualisations TradingView).
