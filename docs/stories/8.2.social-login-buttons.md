# Story 8.2: Social Login Buttons UI

## Status

Draft

## Story

**As a** user,
**I want** to see Google, Apple, and Discord login buttons on the authentication pages,
**so that** I can sign up or log in with one click using my existing accounts.

## Acceptance Criteria

1. Social login buttons are displayed on the login page (`/login`)
2. Social login buttons are displayed on the register page (`/register`)
3. Each button has the correct provider branding (icon, colors)
4. Clicking a button initiates the OAuth flow with Supabase
5. Loading state is shown while OAuth redirect is in progress
6. Error messages are displayed if OAuth fails
7. Buttons are properly translated (FR/EN)
8. UI is responsive and matches existing design system

## Tasks / Subtasks

- [ ] **Task 1: Create SocialLoginButtons Component** (AC: 1, 2, 3, 4, 5, 8)
  - [ ] Create `src/components/auth/social-login-buttons.tsx`
  - [ ] Implement Google button with Google icon and branding
  - [ ] Implement Apple button with Apple icon and branding
  - [ ] Implement Discord button with Discord icon and branding
  - [ ] Add loading state management per button
  - [ ] Call Supabase `signInWithOAuth()` on click

- [ ] **Task 2: Add Provider Icons** (AC: 3)
  - [ ] Use Lucide icons or add custom SVG icons
  - [ ] Google: `<GoogleIcon />` or custom SVG
  - [ ] Apple: `<Apple />` from lucide-react
  - [ ] Discord: Custom SVG (not in lucide)

- [ ] **Task 3: Integrate on Login Page** (AC: 1, 6)
  - [ ] Import `SocialLoginButtons` in `src/app/(auth)/login/page.tsx`
  - [ ] Add divider "ou" / "or" between email form and social buttons
  - [ ] Handle OAuth callback errors from URL params

- [ ] **Task 4: Integrate on Register Page** (AC: 2, 6)
  - [ ] Import `SocialLoginButtons` in `src/app/(auth)/register/page.tsx`
  - [ ] Add divider "ou" / "or" between email form and social buttons

- [ ] **Task 5: Add Translations** (AC: 7)
  - [ ] Add keys to `messages/fr.json` and `messages/en.json`:
    - `auth.continueWithGoogle`
    - `auth.continueWithApple`
    - `auth.continueWithDiscord`
    - `auth.orContinueWith`
    - `auth.socialLoginError`

## Dev Notes

### Supabase OAuth Client Implementation
[Source: Supabase docs - OAuth with PKCE]

```typescript
import { createClient } from '@/lib/supabase/client'

async function signInWithProvider(provider: 'google' | 'apple' | 'discord') {
  const supabase = createClient()
  
  const { error } = await supabase.auth.signInWithOAuth({
    provider,
    options: {
      redirectTo: `${window.location.origin}/auth/callback`,
      // For Discord, request additional scopes
      ...(provider === 'discord' && {
        scopes: 'identify email',
      }),
    },
  })
  
  if (error) {
    console.error('OAuth error:', error)
    throw error
  }
}
```

### Current Login Page Structure
[Source: `src/app/(auth)/login/page.tsx`]

Current layout:
1. Logo + Title
2. Error message area
3. Email input
4. Password input + Forgot password link
5. Submit button
6. Register link

**Insert social buttons** between Submit button and Register link with a divider.

### Current Register Page Structure  
[Source: `src/app/(auth)/register/page.tsx`]

Current layout:
1. Logo + Title
2. Error message / Success message
3. Email input
4. Discord username input
5. Password input
6. Confirm password input
7. Submit button
8. Login link

**Insert social buttons** between Submit button and Login link with a divider.

### Design System
[Source: Existing UI components]

- Use `Button` component with `variant="outline"` for social buttons
- Use existing color scheme: dark background, muted foreground
- Maintain consistent spacing with `space-y-4` or `gap-4`

### Button Styling Reference

```tsx
// Google - White background with subtle border
<Button variant="outline" className="w-full bg-white text-black hover:bg-gray-100">
  <GoogleIcon className="mr-2 h-4 w-4" />
  {t('continueWithGoogle')}
</Button>

// Apple - Black background
<Button variant="outline" className="w-full bg-black text-white hover:bg-gray-900">
  <Apple className="mr-2 h-4 w-4" />
  {t('continueWithApple')}
</Button>

// Discord - Blurple (#5865F2)
<Button variant="outline" className="w-full bg-[#5865F2] text-white hover:bg-[#4752C4]">
  <DiscordIcon className="mr-2 h-4 w-4" />
  {t('continueWithDiscord')}
</Button>
```

### File Structure

```
src/
├── components/
│   ├── auth/
│   │   └── social-login-buttons.tsx  # NEW
│   └── icons/
│       ├── google.tsx                 # NEW (if needed)
│       └── discord.tsx                # NEW
```

### Testing

- **Test file location**: Manual testing (UI component)
- **Test scenarios**:
  1. Click Google button → redirects to Google OAuth
  2. Click Apple button → redirects to Apple OAuth
  3. Click Discord button → redirects to Discord OAuth
  4. Button shows loading state during redirect
  5. Error from URL params is displayed
  6. Responsive layout on mobile

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-07 | 1.0 | Initial draft | SM Agent |

