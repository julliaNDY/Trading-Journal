# Story 7.4: Tags Enhancement - Trades & Days Tags

## Status

**Draft**

---

## Story

**As a** trader,  
**I want** to assign tags to both trades and daily journals,  
**so that** I can organize and filter my trading data efficiently.

---

## Acceptance Criteria

1. **AC1**: Tags assignables aux trades ET aux journées (vérifier implémentation complète).
2. **AC2**: UI pour assigner tags (trades et journées).
3. **AC3**: Filtres par tags (recherche trades/journées par tags).
4. **AC4**: Gestion tags (CRUD : créer, modifier, supprimer tags).
5. **AC5**: Affichage tags sur page trade detail et daily journal.
6. **AC6**: Performance : assignation tags < 500ms.

---

## Tasks / Subtasks

- [ ] **Task 1: Tags Review** (AC: 1)
  - [ ] 1.1 Vérifier tags assignables aux trades (TradeTag existe)
  - [ ] 1.2 Vérifier tags assignables aux journées (DayTag existe)
  - [ ] 1.3 Vérifier schema Prisma (Tag, TradeTag, DayTag)
  - [ ] 1.4 Identifier gaps (si UI manquante)

- [ ] **Task 2: Tags UI** (AC: 2)
  - [ ] 2.1 UI pour assigner tags (trades et journées)
  - [ ] 2.2 Composant TagsSelector dans `src/components/tags/tags-selector.tsx`
  - [ ] 2.3 Multi-select tags (Select multi ou Checkbox group)
  - [ ] 2.4 Actions `assignTagsToTrade(tradeId, tagIds)`, `assignTagsToDay(dayJournalId, tagIds)`
  - [ ] 2.5 UI shadcn/ui (Select, Checkbox, Badge)

- [ ] **Task 3: Tags Filters** (AC: 3)
  - [ ] 3.1 Filtres par tags (recherche trades/journées par tags)
  - [ ] 3.2 Filtres tags dans page trades (Select multi)
  - [ ] 3.3 Filtres tags dans page journal (Select multi)
  - [ ] 3.4 Actions `getTradesByTags(tagIds)`, `getDayJournalsByTags(tagIds)`

- [ ] **Task 4: Tags Management** (AC: 4)
  - [ ] 4.1 Gestion tags (CRUD : créer, modifier, supprimer tags)
  - [ ] 4.2 Page `/tags` ou modal tags management
  - [ ] 4.3 Actions `createTag(name, color)`, `updateTag(tagId, data)`, `deleteTag(tagId)`
  - [ ] 4.4 UI tags management (table + formulaires)

- [ ] **Task 5: Tags Display** (AC: 5)
  - [ ] 5.1 Affichage tags sur page trade detail (badges)
  - [ ] 5.2 Affichage tags sur page daily journal (badges)
  - [ ] 5.3 Composant TagBadge dans `src/components/tags/tag-badge.tsx`
  - [ ] 5.4 Couleurs tags (Tag.color)
  - [ ] 5.5 UI shadcn/ui (Badge)

- [ ] **Task 6: Performance Optimization** (AC: 6)
  - [ ] 6.1 Optimiser assignation tags (< 500ms)
  - [ ] 6.2 Cache tags (Redis) pour éviter queries excessives
  - [ ] 6.3 Benchmark performance
  - [ ] 6.4 Optimiser queries si nécessaire

---

## Dev Notes

- Dépendance : Epic 3 (Données collectées).
- Tags existent partiellement (TradeTag, DayTag), vérifier gaps UI.
- Performance : cache tags pour éviter queries excessives.
- Référencer `docs/roadmap-trading-path-journal.md` Phase 7 (Tags améliorés).
