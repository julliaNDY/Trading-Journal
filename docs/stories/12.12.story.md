# Story 12.12: Synthesis Tab UI (Frontend)

## Status

**Ready for Development**

---

## Story

**As a** trader,  
**I want** to see a dedicated "Synthesis" tab displaying the AI-generated summary,  
**so that** I can quickly understand the final analysis without reading all detailed sections.

---

## Acceptance Criteria

1. **AC1**: Add new tab "Synthesis" in Daily Bias page layout (after "Technical Structure").
2. **AC2**: Tab displays synthesis text (3-5 sentences) in readable format.
3. **AC3**: Synthesis text starts with citation (italicized or styled differently).
4. **AC4**: Display sentiment badge (BULLISH/BEARISH/NEUTRAL) prominently at top.
5. **AC5**: Tab is responsive (mobile-friendly).

---

## Tasks / Subtasks

- [ ] **Task 1: Tab Navigation Update** (AC: 1)
  - [ ] 1.1 Update `src/app/(dashboard)/daily-bias/daily-bias-content.tsx`
  - [ ] 1.2 Add "Synthesis" tab to existing tabs (after "Technical Structure")
  - [ ] 1.3 Tab icon: Use `FileText` from lucide-react
  - [ ] 1.4 Tab order: Security â†’ Macro â†’ Flux â†’ MAG 7 â†’ Technical â†’ **Synthesis**

- [ ] **Task 2: Synthesis Tab Component** (AC: 2, 3, 4)
  - [ ] 2.1 Create `src/components/daily-bias/synthesis-tab.tsx`
  - [ ] 2.2 Props: `{ synthesisText: string, sentiment: SynthesisSentiment, confidence: number }`
  - [ ] 2.3 Layout:
    - Sentiment badge (large, at top)
    - Confidence bar (visual indicator)
    - Synthesis text (body, readable typography)
    - Citation styled differently (italic or muted color for source mentions)

- [ ] **Task 3: Sentiment Badge Styling** (AC: 4)
  - [ ] 3.1 BULLISH: Green background (`bg-green-500/10`), green text, green border
  - [ ] 3.2 BEARISH: Red background (`bg-red-500/10`), red text, red border
  - [ ] 3.3 NEUTRAL: Blue background (`bg-blue-500/10`), blue text, blue border
  - [ ] 3.4 Badge size: Large (`text-lg px-6 py-2`)
  - [ ] 3.5 Icon: TrendingUp (BULLISH), TrendingDown (BEARISH), Minus (NEUTRAL)

- [ ] **Task 4: Citation Styling** (AC: 3)
  - [ ] 4.1 Detect citation pattern: "By analyzing the data provided by..."
  - [ ] 4.2 Style citation text differently:
    - Italic font (`italic`)
    - Muted color (`text-muted-foreground`)
    - Or background highlight (`bg-muted/30 px-2 py-1 rounded`)
  - [ ] 4.3 Regex: `/^By analyzing.*?\.{3}\s*/` to split citation from rest of text

- [ ] **Task 5: Responsive Design** (AC: 5)
  - [ ] 5.1 Mobile (<768px): Single column, badge full width
  - [ ] 5.2 Tablet (768-1024px): Badge centered, text max-width 700px
  - [ ] 5.3 Desktop (>1024px): Badge left-aligned, text max-width 900px
  - [ ] 5.4 Test on mobile simulator + real device

- [ ] **Task 6: Integration with Existing UI** (AC: All)
  - [ ] 6.1 Update `SynthesisCard` component to support tab view (if needed)
  - [ ] 6.2 Pass synthesis data from API response to new tab component
  - [ ] 6.3 Loading state: Skeleton loader while synthesis generating
  - [ ] 6.4 Error state: Display message if synthesis generation failed
  - [ ] 6.5 Empty state: "Synthesis not available" if missing

- [ ] **Task 7: Testing** (AC: All)
  - [ ] 7.1 Visual QA: Verify tab appears after "Technical Structure"
  - [ ] 7.2 Visual QA: Verify sentiment badge colors (green/red/blue)
  - [ ] 7.3 Visual QA: Verify citation styling (italic or highlighted)
  - [ ] 7.4 Responsive QA: Test on mobile, tablet, desktop
  - [ ] 7.5 Integration QA: Verify data flows from API to UI correctly

---

## Parallelization Strategy

**âœ… GROUP A - INDEPENDENT (Can start immediately with mocks)**

Can start **in parallel with Story 12.11** using mock data.

Assignment:
- **DEV 9**: Task 1 (Tab Navigation) - 1h
- **DEV 10**: Task 2 (Component) + Task 3 (Badge Styling) + Task 4 (Citation) - 4h
- **DEV 11**: Task 5 (Responsive) + Task 6 (Integration) - 3h
- **DEV 12**: Task 7 (Testing) - 2h (after other tasks complete)

**Total Time: ~6h** (with 3 devs in parallel: ~4h wall time)

**Mock Data for Development**:
```typescript
const mockSynthesisData = {
  synthesisText: "By analyzing the data provided by CME Group, Federal Reserve, and TradingView technical indicators, NQ1 demonstrates strong bullish momentum with institutional buying pressure and favorable macroeconomic conditions. The MAG 7 correlation remains high, and technical structure shows clear support at 21,500. Overall confidence in this bullish bias is elevated at 78%.",
  sentiment: "BULLISH" as const,
  confidence: 78
};
```

---

## Dependencies

**Blocking**: 
- None (can use mocks to start immediately)
- Story 12.11 (for real data integration in Task 6)

**Blocks**: 
- None (UI-only, doesn't block other stories)

---

## Technical Notes

### Tab Navigation Structure

```typescript
// src/app/(dashboard)/daily-bias/daily-bias-content.tsx
const ANALYSIS_TABS = [
  { id: 'security', label: 'Security', icon: Shield },
  { id: 'macro', label: 'Macro', icon: Globe },
  { id: 'flux', label: 'Institutional Flux', icon: Building },
  { id: 'mag7', label: 'MAG 7', icon: TrendingUp },
  { id: 'technical', label: 'Technical Structure', icon: LineChart },
  { id: 'synthesis', label: 'Synthesis', icon: FileText }, // NEW
];
```

### Synthesis Tab Component

```tsx
// src/components/daily-bias/synthesis-tab.tsx
interface SynthesisTabProps {
  synthesisText: string;
  sentiment: 'BULLISH' | 'BEARISH' | 'NEUTRAL';
  confidence: number;
}

export function SynthesisTab({ synthesisText, sentiment, confidence }: SynthesisTabProps) {
  // Extract citation (first sentence starting with "By analyzing...")
  const citationMatch = synthesisText.match(/^By analyzing.*?\.\.\.\s*/);
  const citation = citationMatch ? citationMatch[0] : '';
  const mainText = citation ? synthesisText.slice(citation.length) : synthesisText;
  
  return (
    <div className="space-y-6">
      {/* Sentiment Badge */}
      <div className="flex items-center justify-between">
        <Badge variant="outline" className={sentimentStyle[sentiment]}>
          <SentimentIcon className="mr-2 h-5 w-5" />
          {sentiment}
        </Badge>
        <span className="text-sm text-muted-foreground">
          Confidence: {confidence}%
        </span>
      </div>
      
      {/* Confidence Bar */}
      <div className="h-2 bg-muted rounded-full overflow-hidden">
        <div 
          className={`h-full ${sentimentBarColor[sentiment]}`}
          style={{ width: `${confidence}%` }}
        />
      </div>
      
      {/* Synthesis Text */}
      <div className="space-y-4">
        {citation && (
          <p className="text-sm italic text-muted-foreground bg-muted/30 px-3 py-2 rounded">
            {citation.trim()}
          </p>
        )}
        <p className="text-base leading-relaxed">
          {mainText}
        </p>
      </div>
    </div>
  );
}
```

### Sentiment Badge Styles

```typescript
const sentimentStyle = {
  BULLISH: 'bg-green-500/10 text-green-500 border-green-500/20 text-lg px-6 py-2',
  BEARISH: 'bg-red-500/10 text-red-500 border-red-500/20 text-lg px-6 py-2',
  NEUTRAL: 'bg-blue-500/10 text-blue-500 border-blue-500/20 text-lg px-6 py-2',
};

const sentimentBarColor = {
  BULLISH: 'bg-green-500',
  BEARISH: 'bg-red-500',
  NEUTRAL: 'bg-blue-500',
};
```

---

## Design Mockup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tabs: [Security][Macro][Flux][MAG7][Technical][Synthesis*] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Confidence: 78%  â”‚
â”‚  â”‚ ğŸ”¼ BULLISH         â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                             â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  78%             â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ By analyzing the data provided by CME  â”‚ â”‚
â”‚  â”‚ Group, Federal Reserve...              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  NQ1 demonstrates strong bullish momentum   â”‚
â”‚  with institutional buying pressure and     â”‚
â”‚  favorable macroeconomic conditions...      â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Definition of Done

- âœ… "Synthesis" tab added after "Technical Structure" tab
- âœ… Sentiment badge displays correctly (green/red/blue with icons)
- âœ… Synthesis text displays with citation styled differently
- âœ… Confidence bar shows visual percentage
- âœ… Responsive design works on mobile, tablet, desktop
- âœ… Loading/error/empty states handled gracefully
- âœ… Visual QA approved (all 3 sentiments tested)
- âœ… Code reviewed and merged

---

## Dev Notes

- **Priority**: ğŸŸ¢ MEDIUM - UI enhancement, not blocking
- **Estimated Effort**: 6 hours (with 3 devs: ~4h wall time)
- **Risk**: Low - Straightforward UI work with clear requirements
- **Testing Strategy**: Visual QA on multiple devices + sentiment states
- ğŸ’¡ **TIP**: Use Storybook to develop component in isolation with all 3 sentiment variants
