# Story 2.5: Backtesting UI - Configuration & Results

## Status

**Draft**

---

## Story

**As a** trader,  
**I want** a UI to configure and run backtests and view results,  
**so that** I can easily test strategies and analyze performance.

---

## Acceptance Criteria

1. **AC1**: Page `/backtesting` avec formulaire configuration backtest.
2. **AC2**: Formulaire : stratégie, symbol, date range, paramètres.
3. **AC3**: Bouton "Run Backtest" lance exécution (async job).
4. **AC4**: Page résultats affiche métriques (PnL, win rate, profit factor) et graphique.
5. **AC5**: Liste historique backtests (table avec filtres).
6. **AC6**: Loading states et error handling.

---

## Tasks / Subtasks

- [ ] **Task 1: Backtesting Page** (AC: 1)
  - [ ] 1.1 Créer `src/app/(dashboard)/backtesting/page.tsx`
  - [ ] 1.2 Layout avec formulaire + résultats
  - [ ] 1.3 Navigation (ajouter route dans sidebar)

- [ ] **Task 2: Configuration Form** (AC: 2)
  - [ ] 2.1 Formulaire (React Hook Form + Zod)
  - [ ] 2.2 Champs : strategyName, symbol, startDate, endDate, params (JSON)
  - [ ] 2.3 Validation dates, symbol requis
  - [ ] 2.4 UI shadcn/ui (Input, Select, DatePicker)

- [ ] **Task 3: Run Backtest Action** (AC: 3)
  - [ ] 3.1 Server action `runBacktest()` dans `src/app/actions/backtesting.ts`
  - [ ] 3.2 Créer job BullMQ (async execution)
  - [ ] 3.3 Retourner job ID pour tracking
  - [ ] 3.4 Gestion erreurs (validation, API limits)

- [ ] **Task 4: Results Display** (AC: 4)
  - [ ] 4.1 Composant résultats (métriques + graphique)
  - [ ] 4.2 Afficher PnL, win rate, profit factor
  - [ ] 4.3 Graphique equity curve (Recharts)
  - [ ] 4.4 Tableau trades (si nécessaire)

- [ ] **Task 5: History List** (AC: 5)
  - [ ] 5.1 Liste backtests passés (table)
  - [ ] 5.2 Filtres (date, symbol, strategy)
  - [ ] 5.3 Pagination
  - [ ] 5.4 Lien vers résultats détaillés

- [ ] **Task 6: Loading & Errors** (AC: 6)
  - [ ] 6.1 Loading state (spinner) pendant exécution
  - [ ] 6.2 Toast notifications (succès, erreur)
  - [ ] 6.3 Error messages clairs
  - [ ] 6.4 Polling job status (si async)

---

## Dev Notes

- Dépendance : Story 2.4 (Backtesting Engine).
- UI responsive (mobile, tablet, desktop).
- i18n : traductions FR/EN pour labels, messages.
- Performance : polling job status (éviter polling excessif, utiliser WebSockets si nécessaire).
- Référencer `docs/roadmap-trading-path-journal.md` Phase 4 (UI Backtesting).
